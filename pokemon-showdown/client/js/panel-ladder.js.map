{"version":3,"file":"panel-ladder.js","names":["LadderFormatRoom","_PSRoom","options","_this","call","classType","format","id","split","notice","searchValue","loading","error","ladderData","setNotice","update","setSearchValue","setError","message","setLadderData","JSON","parse","undefined","requestLadderData","PS","teams","usesLocalLadder","send","toID","Net","get","query","prefix","then","title","BattleLog","formatName","_inheritsLoose","PSRoom","LadderFormatPanel","_PSRoomPanel","_this2","_len","arguments","length","args","Array","_key","apply","concat","changeSearch","e","preventDefault","props","room","base","querySelector","value","_proto","prototype","componentDidMount","_this3","subscriptions","push","subscribe","response","Error","forceUpdate","renderHeader","preact","h","renderSearch","onSubmit","type","name","escapeHTML","placeholder","onChange","renderTable","_room$ladderData","BattleFormats","showCOIL","toplist","coil","style","textAlign","map","row","i","_row$coil","color","fontWeight","usernameColor","userid","username","elo","toFixed","Math","trunc","gxe","slice","rpr","rprd","colSpan","render","PSPanelWrapper","scrollable","href","PSRoomPanel","routes","Model","icon","LadderListPanel","_PSRoomPanel2","_proto2","subscribeTo","renderList","window","currentSection","buf","_i2","_Object$entries2","Object","entries","_ref","rated","searchShow","section","fontSize","padding","Config","users","target","addRoomType"],"sources":["../src/panel-ladder.tsx"],"sourcesContent":["/**\r\n * Ladder Panel\r\n *\r\n * Panel for ladder formats and associated ladder tables.\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>, Adam Tran <aviettran@gmail.com>\r\n * @license MIT\r\n */\r\n\r\nimport { Config, PS, PSRoom } from \"./client-main\";\r\nimport { Net } from \"./client-connection\";\r\nimport { PSPanelWrapper, PSRoomPanel } from \"./panels\";\r\nimport { BattleLog } from \"./battle-log\";\r\nimport { toID, type ID } from \"./battle-dex\";\r\n\r\ntype LadderData = {\r\n\tformatid: ID,\r\n\tformat: string,\r\n\ttoplist: {\r\n\t\tuserid: ID,\r\n\t\tusername: string,\r\n\t\tw: number,\r\n\t\tl: number,\r\n\t\tt: number,\r\n\t\tgxe: number,\r\n\t\tr: number,\r\n\t\trd: number,\r\n\t\tsigma: number,\r\n\t\trptime: number,\r\n\t\trpr: number,\r\n\t\trprd: number,\r\n\t\trpsigma: number,\r\n\t\telo: number,\r\n\t\tfirst_played: number | null,\r\n\t\tlast_played: number | null,\r\n\t\tcoil?: number,\r\n\t}[],\r\n};\r\n\r\nexport class LadderFormatRoom extends PSRoom {\r\n\toverride readonly classType: string = 'ladder';\r\n\treadonly format?: string = this.id.split('-')[1];\r\n\tnotice?: string;\r\n\tsearchValue = '';\r\n\tloading = false;\r\n\terror?: string;\r\n\tladderData?: LadderData;\r\n\r\n\tconstructor(options: any) {\r\n\t\tsuper(options);\r\n\t\tif (this.format) this.title = BattleLog.formatName(this.format);\r\n\t}\r\n\r\n\tsetNotice = (notice: string) => {\r\n\t\tthis.notice = notice;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetSearchValue = (searchValue: string) => {\r\n\t\tthis.searchValue = searchValue;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetError = (error: Error) => {\r\n\t\tthis.loading = false;\r\n\t\tthis.error = error.message;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetLadderData = (ladderData: string | undefined) => {\r\n\t\tthis.loading = false;\r\n\t\tif (ladderData) {\r\n\t\t\tthis.ladderData = JSON.parse(ladderData);\r\n\t\t} else {\r\n\t\t\tthis.ladderData = undefined;\r\n\t\t}\r\n\t\tthis.update(null);\r\n\t};\r\n\trequestLadderData = (searchValue: string) => {\r\n\t\tif (!this.format) return;\r\n\t\tthis.searchValue = searchValue;\r\n\t\tthis.loading = true;\r\n\t\tif (PS.teams.usesLocalLadder) {\r\n\t\t\tthis.send(`/cmd laddertop ${this.format} ${toID(this.searchValue)}`);\r\n\t\t} else if (this.format !== undefined) {\r\n\t\t\tNet(`//pokemonshowdown.com/ladder/${this.format}.json`)\r\n\t\t\t\t.get({\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tprefix: toID(searchValue),\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t\t.then(this.setLadderData)\r\n\t\t\t\t.catch(this.setError);\r\n\t\t}\r\n\t\tthis.update(null);\r\n\t};\r\n}\r\n\r\nclass LadderFormatPanel extends PSRoomPanel<LadderFormatRoom> {\r\n\tstatic readonly id = 'ladderformat';\r\n\tstatic readonly routes = ['ladder-*'];\r\n\tstatic readonly Model = LadderFormatRoom;\r\n\tstatic readonly icon = <i class=\"fa fa-list-ol\" aria-hidden></i>;\r\n\r\n\toverride componentDidMount() {\r\n\t\tconst { room } = this.props;\r\n\t\troom.requestLadderData('');\r\n\t\tthis.subscriptions.push(\r\n\t\t\troom.subscribe((response: any) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tconst [format, ladderData] = response;\r\n\t\t\t\t\tif (room.format === format) {\r\n\t\t\t\t\t\tif (!ladderData) {\r\n\t\t\t\t\t\t\troom.setError(new Error('No data returned from server.'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\troom.setLadderData(ladderData);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.forceUpdate();\r\n\t\t\t})\r\n\t\t);\r\n\t\tthis.subscriptions.push(\r\n\t\t\tPS.teams.subscribe(() => {\r\n\t\t\t\tthis.forceUpdate();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\tchangeSearch = (e: Event) => {\r\n\t\te.preventDefault();\r\n\t\tthis.props.room.requestLadderData(this.base!.querySelector<HTMLInputElement>('input[name=searchValue]')!.value);\r\n\t};\r\n\trenderHeader() {\r\n\t\tif (PS.teams.usesLocalLadder) return null;\r\n\r\n\t\tconst room = this.props.room;\r\n\t\treturn <h3>\r\n\t\t\t{BattleLog.formatName(room.format)} Top\r\n\t\t\t{room.searchValue ? ` - '${room.searchValue}'` : \" 500\"}\r\n\t\t</h3>;\r\n\t}\r\n\trenderSearch() {\r\n\t\tif (PS.teams.usesLocalLadder) return null;\r\n\r\n\t\tconst room = this.props.room;\r\n\t\treturn <form class=\"search\" onSubmit={this.changeSearch}><p>\r\n\t\t\t<input\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tname=\"searchValue\"\r\n\t\t\t\tclass=\"textbox searchinput\"\r\n\t\t\t\tvalue={BattleLog.escapeHTML(room.searchValue)}\r\n\t\t\t\tplaceholder=\"username prefix\"\r\n\t\t\t\tonChange={this.changeSearch}\r\n\t\t\t/> {}\r\n\t\t\t<button type=\"submit\" class=\"button\">Search</button>\r\n\t\t</p></form>;\r\n\t}\r\n\trenderTable() {\r\n\t\tconst room = this.props.room;\r\n\r\n\t\tif (room.loading || !BattleFormats) {\r\n\t\t\treturn <p><i class=\"fa fa-refresh fa-spin\" aria-hidden></i> <em>Loading...</em></p>;\r\n\t\t} else if (room.error !== undefined) {\r\n\t\t\treturn <p>Error: {room.error}</p>;\r\n\t\t} else if (!room.ladderData) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst showCOIL = room.ladderData?.toplist[0]?.coil !== undefined;\r\n\r\n\t\treturn <table class=\"table readable-bg\">\r\n\t\t\t<tr class=\"table-header\">\r\n\t\t\t\t<th></th>\r\n\t\t\t\t<th>Name</th>\r\n\t\t\t\t<th style={{ textAlign: 'center' }}><abbr title=\"Elo rating\">Elo</abbr></th>\r\n\t\t\t\t<th style={{ textAlign: 'center' }}>\r\n\t\t\t\t\t<abbr title=\"user's percentage chance of winning a random battle (Glicko X-Act Estimate)\">GXE</abbr>\r\n\t\t\t\t</th>\r\n\t\t\t\t<th style={{ textAlign: 'center' }}>\r\n\t\t\t\t\t<abbr title=\"Glicko-1 rating system: rating&plusmn;deviation (provisional if deviation>100)\">Glicko-1</abbr>\r\n\t\t\t\t</th>\r\n\t\t\t\t{showCOIL && <th style={{ textAlign: 'center' }}>COIL</th>}\r\n\t\t\t</tr>\r\n\t\t\t{room.ladderData.toplist.map((row, i) => <tr>\r\n\t\t\t\t<td style={{ textAlign: 'right' }}>\r\n\t\t\t\t\t{i < 3 && <i class=\"fa fa-trophy\" aria-hidden style={{ color: ['#d6c939', '#adb2bb', '#ca8530'][i] }}></i>} {i + 1}\r\n\t\t\t\t</td>\r\n\t\t\t\t<td><span\r\n\t\t\t\t\tclass=\"username no-interact\" style={{\r\n\t\t\t\t\t\tfontWeight: i < 10 ? 'bold' : 'normal', color: BattleLog.usernameColor(row.userid),\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{row.username}\r\n\t\t\t\t</span></td>\r\n\t\t\t\t<td style={{ textAlign: 'center' }}><strong>{row.elo.toFixed(0)}</strong></td>\r\n\t\t\t\t<td style={{ textAlign: 'center' }}>{Math.trunc(row.gxe)}<small>.{row.gxe.toFixed(1).slice(-1)}%</small></td>\r\n\t\t\t\t<td style={{ textAlign: 'center' }}><em>{row.rpr.toFixed(0)}<small> &plusmn; {row.rprd.toFixed(0)}</small></em></td>\r\n\t\t\t\t{showCOIL && <td style={{ textAlign: 'center' }}>{row.coil?.toFixed(0)}</td>}\r\n\t\t\t</tr>)}\r\n\t\t\t{!room.ladderData.toplist.length && <tr><td colSpan={5}>\r\n\t\t\t\t<em>No one has played any ranked games yet.</em>\r\n\t\t\t</td></tr>}\r\n\t\t</table>;\r\n\t}\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\treturn <PSPanelWrapper room={room} scrollable>\r\n\t\t\t<div class=\"ladder pad\">\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<button class=\"button\" data-href=\"ladder\" data-target=\"replace\">\r\n\t\t\t\t\t\t<i class=\"fa fa-chevron-left\" aria-hidden></i> Format List\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<button class=\"button\" data-href=\"ladder\" data-target=\"replace\">\r\n\t\t\t\t\t\t<i class=\"fa fa-refresh\" aria-hidden></i> Refresh\r\n\t\t\t\t\t</button> <a class=\"button\" href=\"/view-seasonladder-gen9randombattle\">\r\n\t\t\t\t\t\t<i class=\"fa fa-trophy\" aria-hidden></i> Seasonal rankings\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t{this.renderSearch()}\r\n\t\t\t\t</p>\r\n\t\t\t\t{this.renderHeader()}\r\n\t\t\t\t{this.renderTable()}\r\n\t\t\t</div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nclass LadderListPanel extends PSRoomPanel {\r\n\tstatic readonly id = 'ladder';\r\n\tstatic readonly routes = ['ladder'];\r\n\tstatic readonly icon = <i class=\"fa fa-list-ol\" aria-hidden></i>;\r\n\tstatic readonly title = 'Ladder';\r\n\r\n\toverride componentDidMount() {\r\n\t\tthis.subscribeTo(PS.teams);\r\n\t}\r\n\trenderList() {\r\n\t\tif (!window.BattleFormats) {\r\n\t\t\treturn <p>Loading...</p>;\r\n\t\t}\r\n\t\tlet currentSection = \"\";\r\n\t\tconst buf: JSX.Element[] = [];\r\n\t\tfor (const [id, format] of Object.entries(BattleFormats)) {\r\n\t\t\tif (!format.rated || !format.searchShow) continue;\r\n\t\t\tif (format.section !== currentSection) {\r\n\t\t\t\tcurrentSection = format.section;\r\n\t\t\t\tbuf.push(<h3>{currentSection}</h3>);\r\n\t\t\t}\r\n\t\t\tbuf.push(<div>\r\n\t\t\t\t<a href={`/ladder-${id}`} class=\"blocklink\" style={{ fontSize: '11pt', padding: '3px 6px' }}>\r\n\t\t\t\t\t{BattleLog.formatName(format.id)}\r\n\t\t\t\t</a>\r\n\t\t\t</div>);\r\n\t\t}\r\n\t\treturn buf;\r\n\t}\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\treturn <PSPanelWrapper room={room} scrollable>\r\n\t\t\t<div class=\"ladder pad\">\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<a class=\"button\" href={`//${Config.routes.users}/`} target=\"_blank\">\r\n\t\t\t\t\t\tLook up a specific user's rating\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<button data-href=\"view-ladderhelp\" class=\"button\">\r\n\t\t\t\t\t\t<i class=\"fa fa-info-circle\" aria-hidden></i> How the ladder works\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</p>\r\n\t\t\t\t{this.renderList()}\r\n\t\t\t</div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nPS.addRoomType(LadderFormatPanel, LadderListPanel);\r\n"],"mappings":"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","ignoreList":[]}