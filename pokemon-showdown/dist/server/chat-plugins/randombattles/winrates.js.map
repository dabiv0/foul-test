{
  "version": 3,
  "sources": ["../../../../server/chat-plugins/randombattles/winrates.tsx"],
  "sourcesContent": ["/**\r\n * A chat plugin to store, calculate, and view winrates in random battle formats.\r\n * @author mia-pi-git\r\n */\r\n\r\nimport { FS, Utils } from '../../../lib';\r\n\r\ninterface Stats {\r\n\telo: number;\r\n\tmonth: string;\r\n\tformats: Record<string, FormatData>;\r\n}\r\n\r\ninterface MonEntry {\r\n\ttimesGenerated: number;\r\n\tnumWins: number;\r\n}\r\n\r\ninterface FormatData {\r\n\tmons: Record<string, MonEntry>;\r\n\tperiod?: number; // how often it resets - defaults to 1mo\r\n}\r\n\r\nconst STATS_PATH = Monitor.logPath('randbats/{{MONTH}}-winrates.json').path;\r\nexport const stats = getDefaultStats();\r\n\r\ntry {\r\n\tconst path = STATS_PATH.replace('{{MONTH}}', getMonth());\r\n\tif (!Monitor.logPath('randbats/').existsSync()) {\r\n\t\tMonitor.logPath('randbats/').mkdirSync();\r\n\t}\r\n\tconst savedStats = JSON.parse(FS(path).readSync());\r\n\tstats.elo = savedStats.elo;\r\n\tstats.month = savedStats.month;\r\n\tfor (const k in stats.formats) {\r\n\t\tstats.formats[k] = savedStats.formats[k] || stats.formats[k];\r\n\t}\r\n} catch {}\r\n\r\nfunction getDefaultStats(): Stats {\r\n\treturn {\r\n\t\telo: 1500,\r\n\t\tmonth: getMonth(),\r\n\t\tformats: {\r\n\t\t\t// all of these requested by rands staff. they don't anticipate it being changed much\r\n\t\t\t// so i'm not spending the time to add commands to toggle this\r\n\t\t\tgen9randombattle: { mons: {} },\r\n\t\t\tgen9randomdoublesbattle: { mons: {} },\r\n\t\t\tgen9babyrandombattle: { mons: {} },\r\n\t\t\tgen9superstaffbrosultimate: { mons: {} },\r\n\t\t\tgen8randombattle: { mons: {} },\r\n\t\t\tgen7randombattle: { mons: {} },\r\n\t\t\tgen6randombattle: { mons: {} },\r\n\t\t\tgen5randombattle: { mons: {} },\r\n\t\t\tgen4randombattle: { mons: {} },\r\n\t\t\tgen3randombattle: { mons: {} },\r\n\t\t\tgen2randombattle: { mons: {} },\r\n\t\t\tgen1randombattle: { mons: {} },\r\n\t\t},\r\n\t};\r\n}\r\n\r\nexport function saveStats(month = getMonth()) {\r\n\t// clone to avoid race conditions with the data getting deleted later (on month rollover)\r\n\tconst curStats = { ...stats };\r\n\tFS(STATS_PATH.replace('{{MONTH}}', month)).writeUpdate(() => JSON.stringify(curStats));\r\n}\r\n\r\nfunction getMonth() {\r\n\treturn Chat.toTimestamp(new Date()).split(' ')[0].slice(0, -3);\r\n}\r\n\r\n// no, this cannot be baseSpecies - some formes matter, ex arceus formes\r\n// no, there is no better way to do this.\r\n// yes, i tried.\r\nexport function getSpeciesName(set: PokemonSet, format: Format) {\r\n\tconst species = set.species;\r\n\tconst item = Dex.items.get(set.item);\r\n\tconst moves = set.moves;\r\n\tconst megaRayquazaPossible = ['gen6', 'gen7'].includes(format.mod) && !format.ruleset.includes('Mega Rayquaza Clause');\r\n\tif (species.startsWith(\"Pikachu-\")) {\r\n\t\treturn 'Pikachu';\r\n\t} else if (species.startsWith(\"Unown-\")) {\r\n\t\treturn 'Unown';\r\n\t} else if (species === \"Gastrodon-East\") {\r\n\t\treturn 'Gastrodon';\r\n\t} else if (species === \"Magearna-Original\") {\r\n\t\treturn \"Magearna\";\r\n\t} else if (species === \"Genesect-Douse\") {\r\n\t\treturn \"Genesect\";\r\n\t} else if (species === \"Dudunsparce-Three-Segment\") {\r\n\t\treturn 'Dudunsparce';\r\n\t} else if (species === \"Maushold-Four\") {\r\n\t\treturn 'Maushold';\r\n\t} else if (species === \"Greninja-Bond\") {\r\n\t\treturn 'Greninja';\r\n\t} else if (species === \"Keldeo-Resolute\") {\r\n\t\treturn 'Keldeo';\r\n\t} else if (species === \"Zarude-Dada\") {\r\n\t\treturn 'Zarude';\r\n\t} else if (species === 'Polteageist-Antique') {\r\n\t\treturn 'Polteageist';\r\n\t} else if (species === 'Sinistcha-Masterpiece') {\r\n\t\treturn 'Sinistcha';\r\n\t} else if (species === \"Squawkabilly-Blue\") {\r\n\t\treturn \"Squawkabilly\";\r\n\t} else if (species === \"Squawkabilly-White\") {\r\n\t\treturn \"Squawkabilly-Yellow\";\r\n\t} else if (species.startsWith(\"Basculin-\")) {\r\n\t\treturn \"Basculin\";\r\n\t} else if (species.startsWith(\"Sawsbuck-\")) {\r\n\t\treturn \"Sawsbuck\";\r\n\t} else if (species.startsWith(\"Vivillon-\")) {\r\n\t\treturn \"Vivillon\";\r\n\t} else if (species.startsWith(\"Florges-\")) {\r\n\t\treturn \"Florges\";\r\n\t} else if (species.startsWith(\"Furfrou-\")) {\r\n\t\treturn \"Furfrou\";\r\n\t} else if (species.startsWith(\"Minior-\")) {\r\n\t\treturn \"Minior\";\r\n\t} else if (species.startsWith(\"Toxtricity-\")) {\r\n\t\treturn 'Toxtricity';\r\n\t} else if (species.startsWith(\"Tatsugiri-\")) {\r\n\t\treturn 'Tatsugiri';\r\n\t} else if (species.startsWith(\"Alcremie-\")) {\r\n\t\treturn 'Alcremie';\r\n\t} else if (species === \"Zacian\" && item.name === \"Rusted Sword\") {\r\n\t\treturn 'Zacian-Crowned';\r\n\t} else if (species === \"Zamazenta\" && item.name === \"Rusted Shield\") {\r\n\t\treturn \"Zamazenta-Crowned\";\r\n\t} else if (species === \"Kyogre\" && item.name === \"Blue Orb\") {\r\n\t\treturn \"Kyogre-Primal\";\r\n\t} else if (species === \"Groudon\" && item.name === \"Red Orb\") {\r\n\t\treturn \"Groudon-Primal\";\r\n\t} else if (item.megaStone) {\r\n\t\treturn item.megaStone;\r\n\t} else if (species === \"Rayquaza\" && moves.includes('Dragon Ascent') && !item.zMove && megaRayquazaPossible) {\r\n\t\treturn \"Rayquaza-Mega\";\r\n\t} else if (species === \"Poltchageist-Artisan\") { // Babymons from here on out\r\n\t\treturn \"Poltchageist\";\r\n\t} else if (species === \"Shellos-East\") {\r\n\t\treturn \"Shellos\";\r\n\t} else if (species === \"Sinistea-Antique\") {\r\n\t\treturn \"Sinistea\";\r\n\t} else if (species.startsWith(\"Deerling-\")) {\r\n\t\treturn \"Deerling\";\r\n\t} else if (species.startsWith(\"Flabe\\u0301be\\u0301-\")) {\r\n\t\treturn \"Flabe\\u0301be\\u0301\";\r\n\t} else {\r\n\t\treturn species;\r\n\t}\r\n}\r\n\r\nfunction checkRollover() {\r\n\tif (stats.month !== getMonth()) {\r\n\t\tsaveStats(stats.month);\r\n\t\tObject.assign(stats, getDefaultStats());\r\n\t\tsaveStats();\r\n\t}\r\n}\r\n\r\nconst getZScore = (data: MonEntry) => (\r\n\t2 * Math.sqrt(data.timesGenerated) * (data.numWins / data.timesGenerated - 0.5)\r\n);\r\n\r\nexport const handlers: Chat.Handlers = {\r\n\tonBattleEnd(battle, winner, players) {\r\n\t\tvoid collectStats(battle, winner, players);\r\n\t},\r\n};\r\n\r\nasync function collectStats(battle: RoomBattle, winner: ID, players: ID[]) {\r\n\tconst formatData = stats.formats[battle.format];\r\n\tlet eloFloor = stats.elo;\r\n\tconst format = Dex.formats.get(battle.format);\r\n\tif (format.mod === 'gen2' || format.team === 'randomBaby') {\r\n\t\t// ladders are inactive, so use a lower threshold\r\n\t\teloFloor = 1150;\r\n\t} else if (format.mod !== `gen${Dex.gen}`) {\r\n\t\teloFloor = 1300;\r\n\t} else if (format.gameType === 'doubles') {\r\n\t\t// may need to be raised again if ladder takes off further\r\n\t\teloFloor = 1400;\r\n\t}\r\n\tif (!formatData || (format.mod !== 'gen9ssb' && battle.rated < eloFloor) || !winner) return;\r\n\tcheckRollover();\r\n\tfor (const p of battle.players) {\r\n\t\tconst team = await battle.getPlayerTeam(p);\r\n\t\tif (!team) return; // ???\r\n\t\tconst mons = team.map(f => getSpeciesName(f, format));\r\n\t\tfor (const mon of mons) {\r\n\t\t\tif (!formatData.mons[mon]) formatData.mons[mon] = { timesGenerated: 0, numWins: 0 };\r\n\t\t\tformatData.mons[mon].timesGenerated++;\r\n\t\t\tif (toID(winner) === toID(p.name)) {\r\n\t\t\t\tformatData.mons[mon].numWins++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tsaveStats();\r\n}\r\n\r\nexport const commands: Chat.ChatCommands = {\r\n\trwr: 'randswinrates',\r\n\trandswinrates(target, room, user) {\r\n\t\ttarget = toID(target);\r\n\t\tif (/^(gen|)[0-9]+$/.test(target)) {\r\n\t\t\tif (target.startsWith('gen')) target = target.slice(3);\r\n\t\t\ttarget = `gen${target}randombattle`;\r\n\t\t}\r\n\t\treturn this.parse(`/j view-winrates-${target ? Dex.formats.get(target).id : `gen${Dex.gen}randombattle`}`);\r\n\t},\r\n\trandswinrateshelp: [\r\n\t\t'/randswinrates OR /rwr [format] - Get a list of the win rates for all Pokemon in the given Random Battles format.',\r\n\t],\r\n\r\n\tasync removewinrates(target, room, user) {\r\n\t\tthis.checkCan('rangeban');\r\n\t\tif (!/^[0-9]{4}-[0-9]{2}$/.test(target) || target === getMonth()) {\r\n\t\t\tthrow new Chat.ErrorMessage(`Invalid month: ${target}`);\r\n\t\t}\r\n\t\tconst path = STATS_PATH.replace('{{MON}}', target);\r\n\t\tif (!(await FS(path).exists())) {\r\n\t\t\tthrow new Chat.ErrorMessage(`No stats for the month ${target}.`);\r\n\t\t}\r\n\t\tawait FS(path).unlinkIfExists();\r\n\t\tthis.globalModlog('REMOVEWINRATES', null, target);\r\n\t\tthis.privateGlobalModAction(`${user.name} removed Random Battle winrates for the month of ${target}`);\r\n\t},\r\n};\r\n\r\nexport const pages: Chat.PageTable = {\r\n\tasync winrates(query, user) {\r\n\t\tif (!user.named) return Rooms.RETRY_AFTER_LOGIN;\r\n\t\tquery = query.join('-').split('--');\r\n\t\tconst format = toID(query.shift());\r\n\t\tif (!format) throw new Chat.ErrorMessage(`Specify a format to view winrates for.`);\r\n\t\tif (!stats.formats[format]) {\r\n\t\t\tthrow new Chat.ErrorMessage(`That format does not have winrates tracked.`);\r\n\t\t}\r\n\t\tcheckRollover();\r\n\t\tconst sorter = toID(query.shift() || 'zscore');\r\n\t\tif (!['zscore', 'raw'].includes(sorter)) {\r\n\t\t\tthrow new Chat.ErrorMessage(`Invalid sorting method. Must be either 'zscore' or 'raw'.`);\r\n\t\t}\r\n\t\tconst month = query.shift() || getMonth();\r\n\t\tif (!/^[0-9]{4}-[0-9]{2}$/.test(month)) {\r\n\t\t\tthrow new Chat.ErrorMessage(`Invalid month: ${month}`);\r\n\t\t}\r\n\t\tconst isOldMonth = month !== getMonth();\r\n\t\tif (isOldMonth && !(await FS(STATS_PATH.replace('{{MONTH}}', month)).exists())) {\r\n\t\t\tthrow new Chat.ErrorMessage(`There are no winrates for that month.`);\r\n\t\t}\r\n\t\tconst prevMonth = new Date(new Date(`${month}-15`).getTime() - (30 * 24 * 60 * 60 * 1000)).toISOString().slice(0, 7);\r\n\t\tconst nextMonth = new Date(new Date(`${month}-15`).getTime() + (30 * 24 * 60 * 60 * 1000)).toISOString().slice(0, 7);\r\n\t\tconst prevMonthExists = await FS(STATS_PATH.replace('{{MONTH}}', prevMonth)).exists();\r\n\t\tconst nextMonthExists = await FS(STATS_PATH.replace('{{MONTH}}', nextMonth)).exists();\r\n\t\tconst statData: Stats = month === stats.month ?\r\n\t\t\tstats : JSON.parse(await FS(STATS_PATH.replace('{{MONTH}}', month)).read());\r\n\t\tconst formatData = statData.formats[format];\r\n\t\tif (!formatData) {\r\n\t\t\treturn <div class=\"pad\">\r\n\t\t\t\t<WinratesHeader\r\n\t\t\t\t\tformatID={format} month={month} sorter={sorter} prevMonth={prevMonth}\r\n\t\t\t\t\tprevMonthExists={prevMonthExists} nextMonth={nextMonth} nextMonthExists={nextMonthExists}\r\n\t\t\t\t/>\r\n\t\t\t\t<div class=\"message-error\">No stats for that format found on that month.</div>\r\n\t\t\t</div>;\r\n\t\t}\r\n\t\tthis.title = `[Winrates] [${format}] ${month}`;\r\n\t\tlet sortFn: (val: [string, MonEntry]) => Utils.Comparable;\r\n\r\n\t\tif (sorter === 'zscore') {\r\n\t\t\tsortFn = ([_, data]) => [-getZScore(data), -data.timesGenerated];\r\n\t\t} else {\r\n\t\t\tsortFn = ([_, data]) => [\r\n\t\t\t\t-(data.numWins / data.timesGenerated), -data.numWins, -data.timesGenerated,\r\n\t\t\t];\r\n\t\t}\r\n\t\tconst mons = Utils.sortBy(Object.entries(formatData.mons), sortFn);\r\n\t\treturn <div class=\"pad\">\r\n\t\t\t<WinratesHeader\r\n\t\t\t\tformatID={format} month={month} sorter={sorter} prevMonth={prevMonth}\r\n\t\t\t\tprevMonthExists={prevMonthExists} nextMonth={nextMonth} nextMonthExists={nextMonthExists}\r\n\t\t\t/>\r\n\t\t\t<div class=\"ladder pad\">\r\n\t\t\t\t<table>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th>Pokemon</th>\r\n\t\t\t\t\t\t<th>Win %</th>\r\n\t\t\t\t\t\t<th>Z-Score</th>\r\n\t\t\t\t\t\t<th>Raw wins</th>\r\n\t\t\t\t\t\t<th>Times generated</th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t{mons.map(([mon, data]) => (<tr>\r\n\t\t\t\t\t\t<td>{Dex.species.get(mon).name}</td>\r\n\t\t\t\t\t\t<td>{((data.numWins / data.timesGenerated) * 100).toFixed(2)}%</td>\r\n\t\t\t\t\t\t<td>{getZScore(data).toFixed(3)}</td>\r\n\t\t\t\t\t\t<td>{data.numWins}</td>\r\n\t\t\t\t\t\t<td>{data.timesGenerated}</td>\r\n\t\t\t\t\t</tr>))}\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t},\r\n};\r\n\r\nclass WinratesHeader extends Chat.JSX.Component<{\r\n\tformatID: ID, month: string, sorter: string, prevMonth: string,\r\n\tprevMonthExists: boolean, nextMonth: string, nextMonthExists: boolean,\r\n}> {\r\n\trender() {\r\n\t\tconst { formatID, month, sorter, prevMonth, prevMonthExists, nextMonth, nextMonthExists } = this.props;\r\n\t\tconst formatName = Dex.formats.get(formatID).name;\r\n\t\tconst otherSort = sorter === 'zscore' ? 'Raw' : 'Z-Score';\r\n\t\treturn <>\r\n\t\t\t<h2>Winrates for {formatName} ({month})</h2>\r\n\t\t\t{prevMonthExists &&\r\n\t\t\t\t<a class=\"button\" href={`/view-winrates-${formatID}--${sorter}--${prevMonth}`}>Previous month</a>}\r\n\t\t\t{(prevMonthExists && nextMonthExists) && ' | '}\r\n\t\t\t{nextMonthExists &&\r\n\t\t\t\t<a class=\"button\" href={`/view-winrates-${formatID}--${sorter}--${nextMonth}`}>Next month</a>}\r\n\t\t\t{(prevMonthExists || nextMonthExists) && ' | '}\r\n\t\t\t<a class=\"button\" target=\"replace\" href={`/view-winrates-${formatID}--${toID(otherSort)}--${month}`}>\r\n\t\t\t\tSort by {otherSort} descending\r\n\t\t\t</a>\r\n\t\t\t<hr />\r\n\t\t</>;\r\n\t}\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
